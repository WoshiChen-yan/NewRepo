# 容器无线网络 
## 整体架构（拟定）
+---------------------+  
|      Ryu控制器        |  
| - 分层路由策略引擎     |     # 跨层路径计算（如卫星网关选举）  
| - 全局拓扑数据库       |    # 存储无人机/卫星位置、链路状态  
+----------+----------+  
        OpenFlow/OVSDB  
+----------v----------+  
|    自定义交换机 类       |  **数据平面核心节点**  
| - 流表规则           |  **实现跨层转发**（如匹配卫星流量标记并转至指定端口）    
| - 多级流表           |  **分层处理**  
+----------+----------+  
           | 物理/虚拟链路   
+----------v----------------+  
| 容器网络（无人机/卫星节点）   |   # 容器内通过mac80211_hwsim  无线接口 
+---------------------------+     




## 对于节点的基本设置

### 无线接口的生成
- 对于目前使用原生Ubuntu容器来说，没有办法通过**modprobe**指令直接装载**mac80211_hwsim**模块来生成无线网卡；
- 需要在主机端中生成指定数量的无线网卡通过**ls**软链接指令将容器命名空间与主句内部的命名空间打通后，再把网卡通过**netns**指令分配到对应的命名空间中。



### 基于命令行的容器无线接口基本设置  
- **iw**指令：用于设置无线网卡（接口），包括:无线网卡的工作模式(**type**)、设置无线网卡的发射频率(**txpower**)、无线信道基本信息(**scan\info\reg**)等。

- **ip**指令：用于设置无线网卡的地址，包括*mac*地址、*ip*地址；同时还能设置网卡路由(**ip route**)，作为后续路由策略下放的方式之一。  

- **ping \ fping \ traceroute**指令：用于获取无线链路状态，便于后续作为**networkx**拓扑中中边属性更新，影响路由决策的依据。 
    >后续应该会启用SDN控制器来对路由进行控制 (例如Ryu等)


### 对于无线路由拓扑构构建以及路由策略的部署

        >待填入



## 对于无线介质的设置

### 对于yawmd/wmediumd的介绍

yawmd是对于wmediumd的改进版本，用于模拟无线容器之间真实的模拟，模拟作用在网络层下方（也就是物理层和链路层），基本能满足之前无线介质的要求：
- 三维坐标、三维移动方式
    >对于卫星的移动方式应该后续需要再次修改yawmd源码
- 多介质的实现（即使在同一个介质id中，也能基于id划分出多个无线信道模型，便于后续实验的模拟）
- 支持多种路径损耗模型（ITU、 Log_distance等）

**大问题**：目前没有办法通过yawmd进行传输的配置，一旦进行传输就会出现 **segmentation fault（core dump）**，可能是源代码出现问题，暂时为解决


### 无线网络配置
- 根据传入的节点信息直接配置
- （为了模拟更加真实的节点）使用wmediumd启动后生成的socket套接字，将位置等信息通过套接字直接与wmediumd程序进行沟通（需要进一步探索用途）
    >3月25日完成 基于client-server模式的wmediumd测试，可以动态更新位置（这样就可以在上层模拟各种节点的位置移动）、发射功率、天线增益等，进一步可以将问题变为资源、路由上的优化问题。






